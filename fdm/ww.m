clc
clear


%% initialize the data
%n = input('pls input the num of pointers: ');
n=50;
L = 6.069;
h = L / n;
EI = 2.6336e9;
k = 5.0e7;
rank = 4;
q = 14880;

%A = zeros(n+3,n+3);
x = 0:h:L;
x = x';

b = ones(n+1+2,1)* (h^4*q/EI);
b(n:n+3,1) = 0;
M = zeros(n+1,1);



p1 = ones(n-1,1) * 1;
p1(n:n+3,1) = 0;
p2 = ones(n-1,1)*(-4);
p2(n:n+2,1) = 0;
p3 = ones(n-1,1)*(6+k*h^4/EI);
p3(n:n+1,1) = 0;
p4 = ones(n-1,1)*(-4);
p4(n,1) = 0 ;
p5 = ones(n-1,1) * 1;
A = diag(p1)+diag(p2,1)+diag(p3,2)+diag(p4,3)+diag(p5,4);

%% boundray condition
% w(0) = w(L) = 0   ; w''(0) = w''(L) = 0
%                     w_1-2*w0+w_-1 = wn-2*w_n-1+w_n-2 = 0
A(n,3) = 1;A(n+1,n+3) = 1;
A(n+2,2:4) =  [1 -2 1];
A(n+3,n+1:n+3) = [1 -2 1];



%% compute and plot 
w = A \ b;
for i = 1:n+1
    M(i) = -EI/h^2*((w(i,1)-2*w(i+1,1)+w(i+2,1)));
end

w = w(3:end,1);
subplot(1,3,1);
plot(x,w)

hold on 

%dsolve('D4w = (14880-5e7*w)/2.6336e9','w(0)=0','w(6.069)=0','D2w(0)=0','D2w(6.069)=0','t')

f =@(t) 35312879708383961117861482381531/118658869987849331713244228432563750 - (35312879708383961117861482381531*exp(((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*t*1i)/5000000000000000000000000000000000))/(237317739975698663426488456865127500*(exp(((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*6069i)/5000000000000000000000000000000000000) + 1)) - (35312879708383961117861482381531*exp(-((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*t)/5000000000000000000000000000000000)*exp((6069*(-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4))/5000000000000000000000000000000000000))/(237317739975698663426488456865127500*(exp((6069*(-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4))/5000000000000000000000000000000000000) + 1)) - (35312879708383961117861482381531*exp(-((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*t*1i)/5000000000000000000000000000000000)*exp(((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*6069i)/5000000000000000000000000000000000000))/(237317739975698663426488456865127500*(exp(((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*6069i)/5000000000000000000000000000000000000) + 1)) - (35312879708383961117861482381531*exp(((-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4)*t)/5000000000000000000000000000000000))/(237317739975698663426488456865127500*(exp((6069*(-1)^(1/4)*94927095990279465370595382746051^(1/4)*5000000000000000000000000000000000^(3/4))/5000000000000000000000000000000000000) + 1));
plot(x,real(f(x)))
xlabel('长度')
ylabel('挠度')
legend('差分结果','解析结果')

subplot(1,3,2);
plot(x,M)
title('弯矩图')

subplot(1,3,3);
plot(x,k*w)
title('F')
















